<div class="p-6">
  <h2 mat-dialog-title>Nuevo envío marítimo</h2>
  <mat-dialog-content>
    <form [formGroup]="maritimeShipmentForm" class="grid grid-cols-2 gap-4">
      <mat-form-field appearance="fill">
        <mat-label>Cliente</mat-label>
        <mat-select formControlName="clientId" required>
          @for (client of clients$ | async; track client.id) {
            <mat-option [value]="client.id">
              {{ client.name }}
            </mat-option>
          }
        </mat-select>
        @if (isInvalid('clientId')) {
          <mat-error>Cliente es requerido.</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Producto</mat-label>
        <mat-select formControlName="productId" required>
          @for (product of products$ | async; track product.id) {
            <mat-option [value]="product.id">
              {{ product.name }}
            </mat-option>
          }
        </mat-select>
        @if (isInvalid('productId')) {
          <mat-error>Producto es requerido.</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Puerto</mat-label>
        <mat-select formControlName="portId" required>
          @for (port of ports$ | async; track port.id) {
            <mat-option [value]="port.id">
              {{ port.name }}
            </mat-option>
          }
        </mat-select>
        @if (isInvalid('portId')) {
          <mat-error>Puerto es requerido.</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Cantidad</mat-label>
        <input matInput type="number" formControlName="quantity" required>
        @if (isInvalid('quantity')) {
          <mat-error>Cantidad mínima es 1.</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Fecha de registro</mat-label>
        <input matInput type="date" formControlName="registrationDate" required>
        <mat-datepicker-toggle matIconSuffix [for]="regPicker"></mat-datepicker-toggle>
        <mat-datepicker #regPicker></mat-datepicker>
        @if (isInvalid('registrationDate')) {
          <mat-error>Fecha de registro es requerida.</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Fecha de entrega</mat-label>
        <input matInput type="date" formControlName="deliveryDate" required>
        <mat-datepicker-toggle matIconSuffix [for]="delPicker"></mat-datepicker-toggle>
        <mat-datepicker #delPicker></mat-datepicker>
        @if (isInvalid('deliveryDate')) {
          <mat-error>Fecha de entrega es requerida.</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Costo de envío</mat-label>
        <input matInput type="number" formControlName="shippingCost" required>
        @if (isInvalid('shippingCost')) {
          <mat-error>Costo de envío no puede ser negativo.</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Número de flota</mat-label>
        <input matInput formControlName="fleetNumber" required (input)="uppercaseInput($event)">
        @if (isInvalid('fleetNumber')) {
          <mat-error>Número de flota requerido (5–15 caracteres alfanuméricos).</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="fill" class="col-span-2">
        <mat-label>Número de guía</mat-label>
        <input matInput formControlName="guideNumber" required>
        @if (isInvalid('guideNumber')) {
          <mat-error>El número de guía debe tener 10 caracteres alfanuméricos.</mat-error>
        }
      </mat-form-field>
    </form>
  </mat-dialog-content>
  <mat-dialog-actions align="end">
    <button mat-button (click)="onCancel()">Cancelar</button>
    <button mat-raised-button color="primary" [disabled]="maritimeShipmentForm.invalid" (click)="onSave()">Guardar</button>
  </mat-dialog-actions>
</div>